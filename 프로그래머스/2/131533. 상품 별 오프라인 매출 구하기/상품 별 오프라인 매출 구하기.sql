SELECT P.PRODUCT_CODE, SUM(P.PRICE * S.SALES_AMOUNT) AS SALES
FROM PRODUCT P
LEFT JOIN OFFLINE_SALE S
ON P.PRODUCT_ID = S.PRODUCT_ID                      
GROUP BY P.PRODUCT_CODE
ORDER BY SALES DESC, P.PRODUCT_CODE;

# SELECT a.PRODUCT_CODE, SUM(a.PRICE * b.SALES_AMOUNT) as SALES
# FROM PRODUCT a JOIN OFFLINE_SALE b
# ON a.PRODUCT_ID = b.PRODUCT_ID
# GROUP BY a.PRODUCT_CODE
# ORDER BY SALES desc, a.PRODUCT_CODE;